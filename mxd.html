<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PlugBot Ultra™ | MXD Sales Academy</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      --bg: #0b0b0b;
      --text: #ffffff;
      --accent: #ffffff;
      --card: #1a1a1a;
      --rounded: 16px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      padding: 1rem;
      position: relative;
    }
    .header {
      position: fixed;
      top: 20px;
      left: 20px;
      color: #fff;
      font-weight: 600;
      font-size: 1rem;
      opacity: 0.8;
      z-index: 1000;
    }
    .avatar-bg {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 0;
      pointer-events: none;
      animation: floatBot 4s ease-in-out infinite, glowPulse 3s ease-in-out infinite;
    }
    .avatar-bg img { width: 150px; transition: filter 0.3s ease; }
    .interface {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 1.5rem;
      width: 100%;
      max-width: 480px;
      margin: 0 auto;
      padding-top: 200px;
      z-index: 2;
      position: relative;
    }
    .chat-section {
      background: var(--card);
      border-radius: 24px;
      padding: 1.5rem;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      max-height: 70vh;
      overflow-y: auto;
      scroll-behavior: smooth;
    }
    .chat-section::-webkit-scrollbar { width: 8px; }
    .chat-section::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 10px;
    }
    .chat-section::-webkit-scrollbar-track { background: transparent; }
    .msg-box {
      background: rgba(255, 255, 255, 0.07);
      padding: 0.9rem 1.1rem;
      border-radius: var(--rounded);
      font-size: 0.95rem;
      line-height: 1.4;
      text-align: left;
      animation: fadeIn 0.3s ease;
    }
    .input-row {
      display: none;
      flex-direction: column;
      gap: 0.75rem;
    }
    input {
      padding: 1rem;
      border-radius: var(--rounded);
      border: none;
      background: #111;
      color: #fff;
      font-size: 1rem;
    }
    .btn {
      background: #000;
      color: #fff;
      font-weight: 700;
      border: 1px solid #fff;
      border-radius: var(--rounded);
      padding: 1rem;
      font-size: 1rem;
      cursor: pointer;
      transition: 0.3s ease;
      text-align: center;
      width: 100%;
    }
    .btn:hover {
      background: #fff;
      color: #000;
    }
    .typing {
      font-style: italic;
      opacity: 0.7;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes floatBot {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-8px); }
      100% { transform: translateY(0px); }
    }
    @keyframes glowPulse {
      0%, 100% { filter: drop-shadow(0 0 0px #ffffff); }
      50% { filter: drop-shadow(0 0 12px #ffffff); }
    }
  </style>
</head>
<body>
  <div class="header">MXD Enterprises</div>
  <div class="avatar-bg"><img id="plugbot-avatar" src="https://jacoblemire.github.io/plugbot-ai/plugbot.png" alt="PlugBot"></div>
  <div class="interface">
    <div class="chat-section" id="chat">
      <div class="msg-box"><strong>Get Qualified for MXD Sales Academy</strong></div>
      <div class="msg-box">Learn how to earn $3K–$10K/month remotely through high-ticket sales — even if you’ve never done this before.</div>
      <div id="startInfo" style="display:none">
        <div class="msg-box">We’ll ask a few quick questions to see if this is a fit. Be real — and if you’re serious, don’t leave anything blank.</div>
      </div>
      <div class="input-row" id="inputRow">
        <input type="text" id="input" placeholder="Type here..." onkeydown="if(event.key==='Enter'){sendInput()}" />
      </div>
      <button class="btn" id="startBtn" onclick="startChat()">GET QUALIFIED</button>
    </div>
  </div>

  <script>
    const input = document.getElementById("input");
    const chat = document.getElementById("chat");
    const inputRow = document.getElementById("inputRow");
    const startBtn = document.getElementById("startBtn");
    const startInfo = document.getElementById("startInfo");
    const avatar = document.getElementById("plugbot-avatar");

    const prompts = [
      "First up — what’s your name?",
      "How old are you right now?",
      "Where are you based currently?",
      "What’s your current monthly income?",
      "Do you have any savings to work with if this feels aligned?",
      "Real talk — why are you looking to make remote income?",
      "Ever tried remote work or online sales before?",
      "What’s the dream monthly income that’d feel like freedom to you?",
      "Drop your email — I’ll send over the next steps:",
      "And last one — what’s the best phone number in case we need to follow up?"
    ];

    const fields = ["name", "age", "location", "income", "savings", "reason", "experience", "goal", "email", "phone"];
    let step = -1, data = {}, score = 0, spamCount = 0, conversationEnded = false;

    function delay(ms) { return new Promise(res => setTimeout(res, ms)); }

    function appendMsg(text, typing = false) {
      const box = document.createElement("div");
      box.className = typing ? "msg-box typing" : "msg-box";
      box.innerText = text;
      chat.insertBefore(box, inputRow);
      chat.scrollTop = chat.scrollHeight;
    }

    function disableInput() {
      inputRow.style.display = "none";
      conversationEnded = true;
    }

    function isValidEmail(email) {
      return /.+@.+\..+/.test(email);
    }

    function isValidPhone(phone) {
      return /^[0-9]{10,}$/.test(phone);
    }

    function isSpam(val) {
      return val.length < 2 || /^[^a-zA-Z0-9]+$/.test(val);
    }

    function setAvatar(state) {
      if (state === "happy") avatar.src = "https://jacoblemire.github.io/plugbot-ai/plugbot-happy.png";
      else if (state === "thinking") avatar.src = "https://jacoblemire.github.io/plugbot-ai/plugbot-thinking.png";
      else avatar.src = "https://jacoblemire.github.io/plugbot-ai/plugbot.png";
    }

    const typingIndicator = document.createElement("div");
    typingIndicator.className = "msg-box typing";
    typingIndicator.innerText = "PlugBot is typing...";

    function showTyping() {
      chat.insertBefore(typingIndicator, inputRow);
      chat.scrollTop = chat.scrollHeight;
    }

    function hideTyping() {
      if (typingIndicator.parentElement) chat.removeChild(typingIndicator);
    }

    async function appendAndType(text) {
      showTyping();
      setAvatar("thinking");
      await delay(800);
      hideTyping();
      setAvatar("neutral");
      appendMsg(text);
    }

    async function startChat() {
      startBtn.style.display = "none";
      inputRow.style.display = "flex";
      startInfo.style.display = "block";
      step = 0;
      await delay(500);
      appendAndType(prompts[step]);
    }

    async function sendInput() {
      const val = input.value.trim();
      if (!val || step === -1 || conversationEnded) return;

      appendMsg(val);
      input.value = "";

      if (isSpam(val)) {
        spamCount++;
        if (spamCount >= 2) {
          await appendAndType("Looks like you're not serious. Come back when you're locked in.");
          disableInput();
          return;
        }
      }

      const field = fields[step];
      data[field] = val;

      if (field === "age") {
        const age = parseInt(val);
        if (age < 17) {
          await appendAndType("We only qualify applicants 17+. Come back when you're ready.");
          disableInput();
          return;
        }
        if (age >= 17) score += 2;
      }
      if (field === "income" && parseInt(val) >= 2000) score += 2;
      if (field === "savings" && /\$?[0-9]{3,}/.test(val)) score += 3;
      if (field === "email" && isValidEmail(val)) score += 2;
      if (field === "phone" && isValidPhone(val)) score += 2;
      if (field === "experience" && /yes|have/i.test(val)) score += 1;

      step++;
      if (step < prompts.length) {
        await appendAndType(prompts[step]);
      } else {
        disableInput();
        const status = score >= 10 ? "qualified" : score >= 6 ? "almost" : "unqualified";
        setAvatar(status === "qualified" ? "happy" : "neutral");

        if (status === "unqualified") {
          await appendAndType("Based on your answers, this might not be the right time.");
          await appendAndType("Start with our free course and come back when you're ready:");
          const link = document.createElement("a");
          link.href = "https://mxdenterprises.com/free-course.html";
          link.innerText = "Watch Free Course";
          link.target = "_blank";
          link.className = "btn";
          chat.appendChild(link);
        } else if (status === "almost") {
          await appendAndType("You're close — we recommend starting with our free course to sharpen your skills.");
          await appendAndType("👇 Tap below to watch the free training:");
          const link = document.createElement("a");
          link.href = "https://mxdenterprises.com/free-course.html";
          link.innerText = "Watch Free Course";
          link.target = "_blank";
          link.className = "btn";
          chat.appendChild(link);
        } else {
          await appendAndType("✅ You're aligned. This is a rare opportunity to speak 1-on-1 with an MXD executive.");
          await appendAndType("⚠️ This isn’t a sales pitch. Come prepared and take notes.");
          await appendAndType("👇 Lock in your call below:");
          const link = document.createElement("a");
          link.href = "https://calendly.com/jadafig1";
          link.innerText = "🎉 Book Your Call";
          link.target = "_blank";
          link.className = "btn reward-button";
          chat.appendChild(link);
          confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        }

        fetch("https://hook.us2.make.com/y1tdeyvxp8gqtaifqsthdpiwayas40fp", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            source: "PlugBot Ultra | MXD Sales Page",
            timestamp: new Date().toISOString(),
            status,
            score,
            ...data
          })
        });
      }
    }
  </script>
</body>
</html>
